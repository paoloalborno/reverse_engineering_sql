CREATE ALGORITHM=UNDEFINED DEFINER=`windows_user`@`%` SQL SECURITY DEFINER VIEW `vw_bookings_summary` AS select `p`.`first_name` AS `first_name`,`p`.`last_name` AS `last_name`,`p1`.`name` AS `departure_port`,`p2`.`name` AS `arrival_port`,`v`.`start_date` AS `start_date`,`v`.`end_date` AS `end_date`,`b`.`booking_date` AS `booking_date`,`b`.`price` AS `price` from (((((`fact_bookings` `b` join `dim_passenger` `p` on((`b`.`passenger_id` = `p`.`passenger_id`))) join `dim_segment` `s` on((`b`.`segment_id` = `s`.`segment_id`))) join `dim_voyage` `v` on((`v`.`voyage_id` = `s`.`voyage_id`))) join `dim_port` `p1` on((`p1`.`port_id` = `s`.`start_port_id`))) join `dim_port` `p2` on((`p2`.`port_id` = `s`.`end_port_id`))) order by `v`.`start_date`,`b`.`booking_date`